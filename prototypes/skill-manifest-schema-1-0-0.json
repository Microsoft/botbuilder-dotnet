{
  "$id": "https://microsoft.com/botframework/schemas/skill-manifest-1-0-0.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Skill Manifest",
  "description": "A schema for Bot Framework skill manifests",
  "type": "object",
  "required": [
    "$id",
    "name",
    "version",
    "publisherName",
    "endpoints"
  ],
  "additionalProperties": false,
  "properties": {
    "$schema": {
      "type": "string",
      "format": "uri",
      "description": "The schema to verify this skill manifest against"
    },
    "$id": {
      "type": "string",
      "description": "The identifier for the skill manifest"
    },
    "name": {
      "type": "string",
      "description": "Name of the skill",
      "maxLength": 100
    },
    "version": {
      "type": "string",
      "description": "Skill version",
      "maxLength": 10
    },
    "description": {
      "type": "string",
      "description": "A human readable description for the skill",
      "maxLength": 100
    },
    "publisherName": {
      "type": "string",
      "description": "The name of the skill publisher",
      "maxLength": 100
    },
    "privacyUrl": {
      "type": "string",
      "format": "uri",
      "description": "The URL with the privacy description for the skill"
    },
    "copyright": {
      "type": "string",
      "description": "The copyright for the skill",
      "maxLength": 100
    },
    "license": {
      "type": "string",
      "description": "The license agreement for the skill",
      "maxLength": 100
    },
    "iconUrl": {
      "type": "string",
      "format": "uri",
      "description": "Optional icon to be shown for the skill"
    },
    "tags": {
      "type": "array",
      "uniqueItems": true,
      "description": "An array of strings with tags for the skill"
    },
    "endpoints": {
      "type": "array",
      "minItems": 1,
      "uniqueItems": true,
      "description": "List of endpoints supported by the skill",
      "items": { "$ref": "#/definitions/endpoint" }
    },
    "activities": {
      "type": "object",
      "description": "Definition for the activies accepted by the skill",
      "additionalProperties": {
        "$ref": "#/definitions/activityBase"
      }
    },
    "definitions": {
      "type": "object",
      "description": "Definitions of the structure of object payloads",
      "additionalProperties": {
        "$ref": "http://json-schema.org/draft-07/schema#"
      }
    }
  },
  "definitions": {
    "endpoint": {
      "type": "object",
      "description": "Skill endpoint definition",
      "additionalProperties": false,
      "required": [
        "name",
        "endpointUrl",
        "msAppId"
      ],
      "properties": {
        "name": {
          "type": "string",
          "description": "Unique name for the endpoint",
          "default": "BotFrameworkV3",
          "maxLength": 100
        },
        "protocol": {
          "type": "string",
          "description": "Supported protocol",
          "default": "BotFrameworkV3",
          "maxLength": 40
        },
        "description": {
          "type": "string",
          "title": "Description",
          "description": "Description of the endpoint",
          "examples": [
            "Production bot"
          ],
          "maxLength": 100
        },
        "endpointUrl": {
          "type": "string",
          "title": "Endpoint Url",
          "format": "uri",
          "description": "Endpoint for the skill",
          "examples": [
            "http://contoso.com/api/messaages"
          ]
        },
        "msAppId": {
          "type": "string",
          "title": "Microsoft App Id",
          "pattern": "[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{12}$",
          "description": "The Microsoft AppId for the skill. This app ID is used to authenticate requests"
        }
      }
    },
    "activityBase": {
      "type": "object",
      "description": "An activity with a type",
      "discriminator": {
        "propertyName": "type",
        "mapping": {
          "event": "#/definitions/eventActivity",
          "invoke": "#/definitions/invokeActivity",
          "message": "#/definitions/messageActivity"
        }
      },
      "required": [
        "type"
      ],
      "properties": {
        "type": {
          "type": "string",
          "description": "The activity type",
          "maxLength": 100
        }
      }
    },
    "eventActivity": {
      "type": "object",
      "description": "An activity with Type=Event where the Name property indicates the task that the skill will execute",
      "required": [
        "name"
      ],
      "allOf": [
        {
          "$ref": "#/definitions/activityBase"
        }
      ],
      "properties": {
        "name": {
          "type": "string",
          "description": "The name for the event",
          "examples": [
            "BookFlight"
          ],
          "maxLength": 100
        },
        "description": {
          "type": "string",
          "title": "Description",
          "description": "Description for the activity",
          "maxLength": 100
        },
        "value": {
          "type": "object",
          "description": "The JsonSchema definition of the shape of the value property that this event expects",
          "$ref": "http://json-schema.org/draft-07/schema#"
        },
        "resultValue": {
          "type": "object",
          "description": "The JsonSchema definition of the shape of the resultValue that this event may produce",
          "$ref": "http://json-schema.org/draft-07/schema#"
        }
      }
    },
    "invokeActivity": {
      "type": "object",
      "description": "An activity with Type=Invoke where the Name property indicates the task that the skill will execute",
      "required": [
        "name"
      ],
      "allOf": [
        {
          "$ref": "#/definitions/activityBase"
        }
      ],
      "properties": {
        "name": {
          "type": "string",
          "description": "The name property for the invoke activity",
          "examples": [
            "GetWeather"
          ],
          "maxLength": 100
        },
        "description": {
          "type": "string",
          "title": "Description",
          "description": "Description for the activity",
          "maxLength": 100
        },
        "value": {
          "type": "object",
          "description": "The JsonSchema definition of the shape of the value property that this event expects",
          "$ref": "http://json-schema.org/draft-07/schema#"
        },
        "resultValue": {
          "type": "object",
          "description": "The JsonSchema definition of the shape of the resultValue that this event may produce",
          "$ref": "http://json-schema.org/draft-07/schema#"
        }
      }
    },
    "messageActivity": {
      "type": "object",
      "description": "An activity with Type=Message where the utterance is passed to the skill in the Text property",
      "allOf": [
        {
          "$ref": "#/definitions/activityBase"
        }
      ],
      "properties": {
        "description": {
          "type": "string",
          "title": "Description",
          "description": "Description for the activity",
          "maxLength": 100
        },
        "value": {
          "type": "object",
          "description": "The JsonSchema definition of the shape of the value property that this message would like to have",
          "$ref": "http://json-schema.org/draft-07/schema#"
        },
        "resultValue": {
          "type": "object",
          "description": "The JsonSchema definition of the shape of the resultValue that this message may produce",
          "$ref": "http://json-schema.org/draft-07/schema#"
        }
      }
    }
  }
}